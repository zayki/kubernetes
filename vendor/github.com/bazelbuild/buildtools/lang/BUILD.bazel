load("@io_bazel_rules_go//go:def.bzl", "go_library")
load("//build:build_defs.bzl", "genfile_check_test")

# gazelle:exclude tables.gen.go

genfile_check_test(
    src = "tables.gen.go",
    gen = "tables.go",
)

genrule(
    name = "generateTablesFile",
    # generated by: bazel info build-language > build-language.pb
    # Unable to get this info from within a single bazel.
    srcs = ["build-language.pb"],
    outs = ["tables.go"],
    cmd = "$(location //generatetables) $(SRCS) > $@",
    tools = ["//generatetables"],
)

go_library(
    name = "go_default_library",
    srcs = [
        "tables.go",  # keep
    ],
    importpath = "github.com/bazelbuild/buildtools/lang",
    visibility = ["//visibility:public"],
    deps = [
        "//build_proto:go_default_library",  # keep
    ],
)
